# エラーメッセージ リファレンス

日本語UIにおけるエラーメッセージの設計パターンをまとめたリファレンス。
ユーザーが問題を解決し、次の操作に進める状態にすることを目的とする。
各項目の詳細は公式サイトを参照すること。

> **出典**: 以下のガイドライン項目名は、株式会社SmartHR
> 「[SmartHR Design System ライティング](https://smarthr.design/products/contents/)」
> （© SmartHR, Inc.）より引用。

---

## ガイドライン項目一覧

| # | ガイドライン項目名（出典: SmartHR Design System） | URL |
|---|--------------------------------------------------|-----|
| 1 | エラーメッセージの基本的な考え方 | https://smarthr.design/products/contents/error-messages/overview/ |
| 2 | バックグラウンド処理のライティングパターン | https://smarthr.design/products/contents/error-messages/background-process/ |
| 3 | インライン通知のライティングパターン | https://smarthr.design/products/contents/error-messages/notificationbar/ |

---

## 実装への適用ノート

### エラーメッセージの3要素

エラーメッセージは以下の3要素で構成する。ユーザーがメッセージを見て問題を解決でき、次の操作に進める状態にすることがゴール。

| 要素 | 説明 | 例 |
|------|------|-----|
| **事象** | 何が起きたか（ユーザー視点で説明） | 「ファイルの取り込みに失敗しました。」 |
| **原因** | なぜ発生したか（問題箇所を特定しやすく） | 「文字コードの形式が正しくありません。」 |
| **対処** | どう解消するか（具体的なアクション） | 「UTF-8形式で保存したファイルを再度取り込んでください。」 |

**表示スペース制限時の優先順位**:

```
原因 > 対処 > 事象
```

ユーザーの主目的は「エラーの解消」であるため、解決方法（原因と対処）の表示を優先する。事象はユーザーが既に認知していることが多いため、スペースが足りない場合は省略可能。

---

### エラーメッセージの文体ルール

| ルール | 例 |
|--------|-----|
| 敬体（です/ます）を使う | 「○○できません」「○○してください」 |
| ユーザーを責めない | ✗「入力が間違っています」→ ✓「○○が正しくありません」 |
| 具体的な対処を示す | ✗「エラーが発生しました」→ ✓「○○を確認して、やり直してください」 |
| 技術用語を避ける | ✗「400 Bad Request」→ ✓「入力内容に問題があります」 |

---

### インライン通知のライティングパターン

画面上部やフォーム近くに表示する短い通知メッセージのパターン集。表示スペースが限られるため、ユーザーがひと目で把握できる情報量に制限する。

**エラー原因別パターン**:

| エラー状況 | メッセージテンプレート |
|-----------|---------------------|
| 原因不明のエラー | 「{オブジェクト名}の{操作名}に失敗しました。」 |
| サーバーエラー（リトライ推奨） | 「{オブジェクト名}の{操作名}に失敗しました。時間をおいて、やり直してください。」 |
| 仕様上の制約 | 「{状態}{オブジェクト名}は、{操作名}できません。」 |
| 上限超過 | 「{制限値}を超える{オブジェクト名}は{操作名}できません。」 |
| 下限未満 | 「{制限値}に満たない{オブジェクト名}は{操作名}できません。」 |
| 登録数の上限 | 「{オブジェクト名}は{制限値}件までしか登録できません。」 |
| 予期しないエラー | 「予期しないエラーが発生しました。時間をおいて、やり直してください。」 |

**入力バリデーション別パターン**:

| バリデーション | メッセージテンプレート |
|-------------|---------------------|
| 未入力 | 「{項目名}が入力されていません。」 |
| 未選択 | 「{項目名}が選択されていません。」 |
| 値が不正 | 「{項目名}が正しくありません。」 |
| 値の不一致 | 「{項目名A}と{項目名B}が一致しません。」 |
| 既に実行済み | 「{オブジェクト名}は、すでに{操作名}済みです。」 |
| 対象が存在しない | 「{オブジェクト名}がありません。」 |
| アクセス権限なし | 「アクセスできません。」/「アクセス権限がありません。」 |

**置換ルール**:
- 「件」は文脈に応じて「個」「つ」に置換可能
- 「登録」は「追加」「アップロード」に置換可能
- オブジェクト名は「選択した」「対象の」で修飾可能

---

### バックグラウンド処理のエラーパターン

非同期処理の結果をユーザーに通知する際のパターン。結果概要とエラー詳細の2層構造にする。

**基本構造**:

```
┌─────────────────────────────────────────┐
│ 結果概要（1行）                            │
│ → ユーザーの操作結果を端的に伝える           │
├─────────────────────────────────────────┤
│ エラー詳細（複数行可）                      │
│ → 失敗の理由と解決方法を具体的に記載         │
└─────────────────────────────────────────┘
```

**結果概要のテンプレート**:

| 状況 | テンプレート |
|------|------------|
| 処理全体が失敗 | 「{処理名}に失敗しました。」 |
| 一部が失敗 | 「{N}件の{操作目的}に失敗しました。」 |
| 処理の受付失敗 | 「{処理名}の受け付けに失敗しました。」 |

**エラー詳細のテンプレート**:

| エラー種別 | テンプレート |
|-----------|------------|
| ファイル形式エラー | 「{指定形式}にしたファイルを取り込んでください。」 |
| ヘッダー項目の誤り | 「{N}列目：項目名が誤っています。」 |
| 必須項目の未入力 | 「{N}列目：入力必須の列がありません（{列名}）。」 |
| 値が不正 | 「{N}行目：入力された{オブジェクト名}が正しくありません。」 |
| 制限値超過 | 「{N}行目：{制限値}を超える{オブジェクト名}です。」 |
| 権限不足 | 「あなたのアカウント権限では操作が許可されていません。」 |

---

### エラーメッセージの設計判断基準

エラーメッセージを書く際に迷ったときの判断フロー。

```
1. ユーザーが自分で解決できるエラーか？
   ├─ Yes → 原因と具体的な対処方法を提示する
   └─ No → 次へ

2. リトライで解決する可能性があるか？
   ├─ Yes → 「時間をおいて、やり直してください」を提示する
   └─ No → 次へ

3. サポートへの問い合わせが必要か？
   ├─ Yes → 問い合わせ先への動線を提示する
   └─ No → 「予期しないエラーが発生しました」＋リトライ案内
```

**避けるべきパターン**:

| パターン | 理由 | 改善例 |
|---------|------|--------|
| 「エラーが発生しました」のみ | 対処方法が不明 | 原因と対処を追記する |
| エラーコードのみ | ユーザーが理解できない | 人間が読める説明に置き換える |
| 結果概要と詳細の内容が重複 | 情報量が増えず冗長 | それぞれ異なる情報を提供する |
| 対処方法が「管理者に問い合わせてください」のみ | ユーザーが自力で解決できない | 可能な限り具体的な手順を示す |

---

## 関連リファレンス

- [writing-style.md](writing-style.md) — 基本的な考え方
- [idiomatic-usage.md](idiomatic-usage.md) — 用字用語
- [ui-text.md](ui-text.md) — UIテキスト
