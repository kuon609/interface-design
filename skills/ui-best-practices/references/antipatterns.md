# アンチパターン リファレンス

## ダークパターン（絶対に実装しない）

ダークパターンとはユーザーを騙すデザイン手法。非倫理的で信頼を損ない、多くの国で違法になりつつある。

### 一覧

| パターン | 説明 | 例 |
|---------|------|-----|
| **偽の緊急性** | リセットされるカウントダウンや在庫切れの偽装 | 「残り 2:00」でリセットされるタイマー |
| **オプトアウトの罪悪感操作** | オプトアウトを悪く見せる | 「いいえ、節約したくありません」 |
| **入会容易・退会困難** | 入りやすく出にくい | 簡単な購読、見つけにくい解約 |
| **偽装広告** | コンテンツ/ナビに見せかけた広告 | 「おすすめ」と表示される有料掲載 |
| **注意の誘導** | 本来の操作から目を逸らす | 本来のアクション付近の派手なアニメーション |
| **わかりにくい質問** | チェックボックスのわかりにくい二重否定 | 「プロモーションメールを受信しない」 |
| **隠れたコスト** | 手順の後半で料金が表示される | 最終ステップで税金・手数料が出る |
| **強制的な継続** | 無料トライアルが通知なく有料に転換 | 期限前の明確な通知なしに課金 |
| **プライバシーの操作** | デフォルトでデータ共有が多い | 「パートナーと共有する」が事前にチェック済み |
| **おとり商法** | 何かを提供して別のものを渡す | 「無料プラン」に有用な機能がない |
| **妨害** | 望むアクションを困難にする | 解約に電話が必要 |
| **執拗な催促** | 同じお願いのポップアップが繰り返し出る | 通知有効化の毎日の modal |

---

## UX アンチパターン

### 説明なしの無効化ボタン

```
❌  [変更を保存]  ← 無効化、なぜかわからない
✓   [変更を保存]  ← 無効化
    「保存するには必須項目をすべて入力してください」
    ← tooltip またはインラインメッセージが不足内容を説明
```

さらに良い方法：送信を許可してエラーをインラインで表示する。

### 送信後のみのバリデーション

```
❌  ユーザーが 8 つのフィールドを入力 → 送信 → 3 つのエラーが一度に表示
✓   blur 時にバリデーション → ユーザーが進むにつれフィールドごとにエラーが表示
```

### 回復方法のないエラーメッセージ

```
❌  「エラーが発生しました。もう一度お試しください。」
✓   「サーバーへの接続に失敗しました。インターネット接続を確認してから再試行してください。」
    [再試行]  または  [サポートに連絡]
```

### 何でも確認ダイアログ

確認 modal の多用はユーザーが内容を読まずにクリックする習慣を作る：

```
❌  「変更を保存しますか？」→ はい / いいえ
✓   確認なしで保存（取り消せる）
    「「プロジェクト Alpha」を完全に削除しますか？」→ キャンセル / 削除
    ← 本当に不可逆で影響の大きい操作にのみダイアログを使う
```

### タッチデバイスでのホバー専用コンテンツ

```
❌  <td title="全説明を見る">切り詰めテキスト</td>
    ← ネイティブの title tooltip はタッチで表示されない
❌  ホバー時のみ表示されるメニューアイテム
✓   ホバーだけでなくフォーカスでも tooltip を表示
✓   切り詰めたコンテンツに可視の「もっと見る」を提供
```

### 操作後のフィードバックなしのリダイレクト

```
❌  フォーム送信 → リダイレクト → 成功したかどうかわからない
✓   フォーム送信 → 短い成功状態または確認ビュー → リダイレクト
```

### 位置記憶のないインフィニットスクロール

```
❌  200 件目までスクロール → クリック → 詳細へ → 戻る → 先頭に戻る
✓   戻るナビゲーション時にスクロール位置を復元する
✓   または代わりにページネーションを使う
```

### コンテキストなしのページネーション

```
❌  「2 ページ目」— 全部で何ページあるかわからない
✓   「2 / 14 ページ」または「247 件中 21〜40 件を表示」
```

### ラベル / tooltip なしのアイコンのみインタラクション

```
❌  <button><TrashIcon /></button>  ← 何をするボタン？
✓   <button aria-label="削除"><TrashIcon /></button>
    + ホバー/フォーカス時の tooltip：「削除」
✓   さらに良い：スペースがある場合はアイコン + 可視ラベル
```

### 自動保存/離脱警告なしの長いフォーム

```
❌  ユーザーが 10 分かけてフォームを入力 → 別のページに移動 → データが消える
✓   下書きを自動保存（特にリッチテキスト/長いフォームの場合）
✓   未保存の変更がある場合に離脱前に警告：
    「未保存の変更があります。このページを離れますか？」
```

### バリデーションエラー時のフォームリセット

```
❌  バリデーション失敗 → フォームがクリアされる → ユーザーが再入力
✓   全ての値を保持し、最初のエラーにスクロールし、修正されたらエラーをクリア
```

### ローディング状態の欠如

```
❌  ユーザーが「送信」をクリック → 2 秒間何も起きない → 再クリック → 二重送信
✓   即座にボタンを無効化 + spinner 表示 → 完了 → 結果を表示
```

### 壊れた戻るボタン

```
❌  フォーム送信後に「戻る」をクリックすると空のフォームやエラー状態になる
✓   適切なナビゲーションパターンを使用し、SPA でもヒストリーを正しく処理する
```

---

## 視覚的アンチパターン

### レインボー UI（カラーの混乱）

```
❌  各セクションが意味のない異なるアクセントカラーを持つ
✓   ブランドカラー 2〜3 色 + セマンティックカラー（成功、警告、エラー）に留める
    カラーは意図を持って控えめに使う
```

### テキストの壁

```
❌  視覚的な区切りのない段落だらけの設定ページ
✓   関連する 3〜5 項目ごとにセクション見出し
    セクション間の余白
    インラインヘルプは短く（最大 1〜2 文）
```

### ランダムなスペーシング

```
❌  margin-top: 17px; padding: 11px 23px; gap: 7px;
✓   スペーシングスケールの値のみ使用：4, 8, 12, 16, 24, 32...
```

### ボーダーの多用

```
❌  全要素の周り、全行の間、全カードにボーダー
✓   余白で要素を区別する
    構造的な区切りにのみボーダーを使う
    要素タイプごとに 1 種類のボーダースタイル
```

### シャドウの不一致

```
❌  card-1: box-shadow: 0 1px 3px rgba(0,0,0,0.12)
    card-2: box-shadow: 2px 2px 5px rgba(0,0,0,0.3)
    card-3: filter: drop-shadow(...)
✓   3〜4 段階のシャドウを design token として定義し一貫して使う：
    --shadow-sm / --shadow-md / --shadow-lg / --shadow-xl （design token として定義）
```

### 密度の不統一

```
❌  コンパクトなデータテーブルの隣に padding 48px のカード
✓   早い段階で密度を決める：「コンパクト」「標準」「ゆったり」
    全コンポーネントに一貫して適用する
```

### タイポグラフィの混乱

```
❌  6 種類のフォントサイズ、4 種類のウェイト、2 種類のフォントファミリーが不規則に散在
✓   定義済みのタイプスケールを使う（最大 5〜6 種）
    各サイズにセマンティックな役割（見出し、サブ見出し、本文、キャプション、ラベル）
```

### 選択済み/アクティブ状態の欠如

```
❌  選択されているかどうかに関わらずナビゲーションアイテムが同じ見た目
❌  選択されているかどうかに関わらずテーブル行が同じ見た目
✓   選択状態はデフォルトとホバーの両方から明確に区別できる
    最低限：背景 + テキストカラーの変化を使う
```

### アラート / toast の多用

```
❌  保存のたびに、ナビゲーションのたびに、些細な操作のたびに toast 表示
✓   明白でない結果を持つ操作にのみ toast を使う
    期待通りの操作（自動保存、フィールド更新）はサイレント
    フォームフィールドにはインライン成功状態（フィールド近くの緑のチェックマーク）を使う
```

### 汎用的な空状態

```
❌  [何もない白い領域]
❌  「データがありません」
✓   アイコン + 見出し + 説明 + アクション（states.md 参照）
```

---

## コードレベルのアンチパターン

### disabled 属性なしの pointer-events 無効化

```
❌  /* 見た目は無効化されているがキーボード操作は受け付ける */
    .btn-disabled { opacity: 0.5; pointer-events: none; }

✓  /* フォームボタンの正しいパターン */
    <button disabled>...</button>

✓  /* フォーム以外のボタンの正しいパターン */
    <button aria-disabled="true" tabindex="-1">...</button>
```

### インタラクション防止なしの cursor: not-allowed

```css
❌  .disabled { cursor: not-allowed; }
    /* 一部のブラウザでは click が発火する */

✓  .disabled {
     cursor: not-allowed;
     pointer-events: none;  /* または disabled 属性 */
   }
```

### サイレントエラー

```
❌  try { await save() } catch (e) { console.log(e) }
    // ユーザーには何も表示されない

✓  try { await save() } catch (e) {
     showError("保存に失敗しました: " + e.message)
   }
```

### フィードバックに alert() を使う

```
❌  alert("保存しました！")
✓   toast 通知またはインラインの確認を表示する
```

### タイムアウトなしのローディング状態

```
❌  setLoading(true); await fetch(url); setLoading(false)
    // fetch がフリーズしたら？ 永遠にローディングのまま

✓  const controller = new AbortController()
   const timeout = setTimeout(() => controller.abort(), 10000)
   try {
     setLoading(true)
     await fetch(url, { signal: controller.signal })
   } catch (e) {
     if (e.name === 'AbortError') showError("タイムアウトしました。再試行してください。")
     else showError(e.message)
   } finally {
     clearTimeout(timeout)
     setLoading(false)
   }
```

### ナビゲーションリンクに window.location を使う

```
❌  <div onClick={() => window.location.href = '/settings'}>設定</div>
    // 壊れる：右クリックで新しいタブを開く、ミドルクリック、アクセシビリティ

✓   <a href="/settings">設定</a>
    // またはルーターで：<Link to="/settings">設定</Link>
```

### エラーハンドリングなしのハードコードされたローディングテキスト

```
❌  {isLoading && <p>読み込み中...</p>}
    // リクエストが失敗しても永遠に表示され続ける

✓  {isLoading && <Spinner />}
   {error && <ErrorState error={error} onRetry={refetch} />}
   {!isLoading && !error && data && <Content data={data} />}
   {!isLoading && !error && !data && <EmptyState />}
```
